{
  "load_csv_pandas": {
    "code": "# /// script\n# requires-python = \">=3.11\"\n# dependencies = [\n#     \"pandas\",\n# ]\n# ///\nimport pandas as pd\nimport pathlib\n\n# Self-healing: Generate data if missing for portability\npath = pathlib.Path(\"data.csv\")\nif not path.exists():\n    pd.DataFrame({\n        \"id\": [1, 2, 3],\n        \"name\": [\"Alice\", \"Bob\", \"Charlie\"],\n        \"city\": [\"NY\", \"SF\", \"LA\"]\n    }).to_csv(path, index=False)\n\n# Basic CSV loading\ndf = pd.read_csv(path)\nprint(f\"Pandas loaded {len(df)} rows:\")\nprint(df.head())\n\n# With options\ndf = pd.read_csv(\n    path,\n    sep=\",\",\n    header=0,\n    dtype={\"id\": int, \"name\": str},\n)",
    "language": "python",
    "output": "Pandas loaded 3 rows:\n   id     name city\n0   1    Alice   NY\n1   2      Bob   SF\n2   3  Charlie   LA\n"
  },
  "load_csv_polars": {
    "code": "# /// script\n# requires-python = \">=3.11\"\n# dependencies = [\n#     \"polars\",\n# ]\n# ///\nimport polars as pl\nimport pathlib\n\n# Self-healing: Generate data if missing for portability\npath = pathlib.Path(\"data.csv\")\nif not path.exists():\n    pl.DataFrame({\n        \"id\": [1, 2, 3],\n        \"name\": [\"Alice\", \"Bob\", \"Charlie\"],\n        \"city\": [\"NY\", \"SF\", \"LA\"]\n    }).write_csv(path)\n\n# Basic CSV loading (eager)\ndf = pl.read_csv(path)\nprint(f\"Polars loaded {len(df)} rows:\")\nprint(df.head())\n\n# Lazy loading (recommended for large files)\nlf = pl.scan_csv(path)\ndf = lf.collect()",
    "language": "python",
    "output": "Polars loaded 3 rows:\nshape: (3, 3)\n\u250c\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 id  \u2506 name    \u2506 city \u2502\n\u2502 --- \u2506 ---     \u2506 ---  \u2502\n\u2502 i64 \u2506 str     \u2506 str  \u2502\n\u255e\u2550\u2550\u2550\u2550\u2550\u256a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256a\u2550\u2550\u2550\u2550\u2550\u2550\u2561\n\u2502 1   \u2506 Alice   \u2506 NY   \u2502\n\u2502 2   \u2506 Bob     \u2506 SF   \u2502\n\u2502 3   \u2506 Charlie \u2506 LA   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"
  },
  "load_csv_duckdb": {
    "code": "# /// script\n# requires-python = \">=3.11\"\n# dependencies = [\n#     \"duckdb\",\n# ]\n# ///\nimport duckdb\nimport pathlib\n\n# Self-healing: Generate data if missing for portability\npath = pathlib.Path(\"data.csv\")\nif not path.exists():\n    import pandas as pd\n    pd.DataFrame({\n        \"id\": [1, 2, 3],\n        \"name\": [\"Alice\", \"Bob\", \"Charlie\"],\n        \"city\": [\"NY\", \"SF\", \"LA\"]\n    }).to_csv(path, index=False)\n\n# Query CSV directly\nresult = duckdb.sql(f\"SELECT * FROM '{path}'\")\nprint(f\"DuckDB found {len(result.fetchall())} rows:\")\nduckdb.sql(f\"SELECT * FROM '{path}'\").show()",
    "language": "python",
    "output": "DuckDB found 3 rows:\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  id   \u2502  name   \u2502  city   \u2502\n\u2502 int64 \u2502 varchar \u2502 varchar \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502     1 \u2502 Alice   \u2502 NY      \u2502\n\u2502     2 \u2502 Bob     \u2502 SF      \u2502\n\u2502     3 \u2502 Charlie \u2502 LA      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n"
  },
  "load_csv_bigquery": {
    "code": "# /// script\n# requires-python = \">=3.11\"\n# dependencies = [\n#     \"google-cloud-bigquery\",\n#     \"pandas\",\n# ]\n# ///\nimport unittest.mock as mock\nfrom google.cloud import bigquery\nimport pandas as pd\nimport pathlib\n\n# Self-healing: Generate data if missing for portability\npath = pathlib.Path(\"data.csv\")\nif not path.exists():\n    pd.DataFrame({\n        \"id\": [1, 2, 3],\n        \"name\": [\"Alice\", \"Bob\", \"Charlie\"],\n        \"city\": [\"NY\", \"SF\", \"LA\"]\n    }).to_csv(path, index=False)\n\n# Mock the client for CI/verification purposes\nclient = mock.MagicMock(spec=bigquery.Client)\n\n# Initialize client (Mocked for verification)\n# client = bigquery.Client()\n\n# Load CSV from local file to BigQuery table\ntable_id = \"project.dataset.table_name\"\n\njob_config = bigquery.LoadJobConfig(\n    source_format=bigquery.SourceFormat.CSV,\n    skip_leading_rows=1,\n    autodetect=True,\n)\n\n# Mocking the load_table_from_file behavior\njob = client.load_table_from_file(None, table_id, job_config=job_config)\njob.result() \n\nprint(f\"Mock BigQuery load triggered for {table_id}\")",
    "language": "python",
    "output": "Mock BigQuery load triggered for project.dataset.table_name\n"
  }
}